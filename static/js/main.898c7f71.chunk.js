(this.webpackJsonpchat_client=this.webpackJsonpchat_client||[]).push([[0],{51:function(e,t,a){e.exports=a(62)},56:function(e,t,a){},57:function(e,t,a){},62:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(9),o=a.n(r),c=(a(56),a(27)),u=a(28),i=a(32),l=a(29),d=a(12),h=a(33),m=(a(57),a(31)),p=a(94),v=a(96),g=a(35),b=a(98),f=a(99),S=a(100),w=a(103),E=a(101),O=a(102),y=a(40);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(a,!0).forEach((function(t){Object(y.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x=s.a.createContext({msg:[{event:"ServerStatus",created:"2019-10-28 03:16:10 -0700",user:"",message:"",status:"started"},{event:"ServerStatus",created:"2019-10-28 03:16:10 -0900",user:"",message:"",status:"startedAgain"}],user:["user1","Sekiro","Gehrman"],addMsg:function(){},addUser:function(){},deleteUser:function(){},setToken:function(){},authToken:""});function P(e){var t={msg:[{event:"ServerStatus",created:"2019-10-28 03:16:10 -0700",user:"",message:"",status:"started"},{event:"ServerStatus",created:"2019-10-28 03:16:10 -0900",user:"",message:"",status:"startedAgain"}],user:["user1","Sekiro","Gehrman"],addMsg:function(e){var t=r.msg;t.push(e),o(j({},r,{msg:t}))},addUser:function(e){var t=r.user;t.push(e),o(j({},r,{user:t}))},setToken:function(e){r.authToken=e},authToken:""},a=s.a.useState(t),n=Object(m.a)(a,2),r=n[0],o=n[1];return s.a.createElement(x.Provider,{value:r},e.children)}var C=Object(p.a)((function(e){return{root:{margin:"100px",padding:e.spacing(3,2)},flex:{display:"flex",alignItems:"center"},userWindow:{width:"30%",height:"500px",borderRight:"1px solid black"},chatWindow:{width:"70%",height:"500px",padding:"30px"},chatBox:{width:"85%"},button:{width:"15%"}}}));function N(){var e=C(),t=s.a.useContext(x),a=s.a.useState(""),n=Object(m.a)(a,2),r=n[0],o=n[1];return s.a.createElement("div",null,s.a.createElement(v.a,{className:e.root},s.a.createElement(g.a,{variant:"h5",component:"h3"},"Chat App"),s.a.createElement(g.a,{component:"p"},"Placeholder"),s.a.createElement("div",{className:e.flex},s.a.createElement("div",{className:e.userWindow},s.a.createElement(b.a,null,t.user.map((function(e){return s.a.createElement(f.a,{key:e,button:!0},s.a.createElement(S.a,{primary:e}))})))),s.a.createElement("div",{className:e.chatWindow},t.msg.map((function(t,a){return s.a.createElement("div",{className:e.flex,key:a},s.a.createElement(w.a,{label:t.user,className:e.chip}),s.a.createElement(g.a,{component:"p"},t.created," ",t.event," ",t.user," ",t.message," ",t.status," "))})))),s.a.createElement(O.a,{label:"send a message",className:e.chatBox,value:r,onChange:function(e){return o(e.target.value)}}),s.a.createElement(E.a,{variant:"contained",color:"primary",className:e.button,onClick:function(){!function(e,t){console.log("The passed in token is "+t);var a=new XMLHttpRequest;a.open("POST","http://localhost:4567/message",!0);var n=new FormData;n.append("message",e),a.setRequestHeader("Authorization","Bearer ".concat(t)),a.onreadystatechange=function(){4===a.readyState&&201===a.status&&console.log("Message received:"+e)},a.send(n)}(r,t.authToken),o("")}},"Send")))}var M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={username:"",password:"",showPopup:!0},a.handleChangeUsername=a.handleChangeUsername.bind(Object(d.a)(a)),a.handleChangePassword=a.handleChangePassword.bind(Object(d.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a.startEventSource=a.startEventSource.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"startEventSource",value:function(e){console.log("eventSource started"),this.eventSource=new EventSource("http://localhost:4567/stream/".concat(e));this.context.msg;var t=this.context.addMsg,a=this.context.addUser;this.context.deleteUser;this.eventSource.addEventListener("Disconnect",(function(e){var a=JSON.parse(e.data);t({event:"Disconnect",created:"".concat(a.created),user:"",users:"",message:"",status:""}),console.log("Disconnect")})),this.eventSource.addEventListener("Message",(function(e){var a=JSON.parse(e.data);t({event:"Message",created:"".concat(a.created),user:"".concat(a.user),users:"",message:"".concat(a.message),status:""}),console.log("Message from: "+a.user)})),this.eventSource.addEventListener("Join",(function(e){var n=JSON.parse(e.data);t({event:"Join",created:"".concat(n.created),user:"".concat(n.user),users:"",message:"",status:""}),a(n.user),console.log("Join")})),this.eventSource.addEventListener("Part",(function(e){var a=JSON.parse(e.data);t({event:"Part",created:"".concat(a.created),user:"".concat(a.user),users:"",message:"",status:""}),console.log("Part")})),this.eventSource.addEventListener("ServerStatus",(function(e){var a=JSON.parse(e.data);t({event:"ServerStatus",created:"".concat(a.created),user:"",users:"",message:"",status:"server started"}),console.log("ServerStatus")})),this.eventSource.addEventListener("Users",(function(e){var a=JSON.parse(e.data);t({event:"Users",created:"".concat(a.created),user:"",users:"jsonData.users",message:"",status:""}),console.log("Users")}))}},{key:"handleChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"handleChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=new XMLHttpRequest,n=new FormData;n.append("username",this.state.username),n.append("password",this.state.password),a.open("POST","http://localhost:4567/login",!0),a.onreadystatechange=function(e){if(4===a.readyState&&201===a.status){var n=t.context.setToken,s=JSON.parse(a.responseText);t.startEventSource(s.token),n(s.token)}},a.send(n),this.props.handleSubmit()}},{key:"render",value:function(){return s.a.createElement("div",{style:{position:"fixed",width:"100%",height:"100%",top:"0",left:"0",right:"0",bottom:"0",margin:"auto",backgroundColor:"grey"},className:"popup"},s.a.createElement("div",{style:{position:"absolute",left:"25%",right:"25%",top:"25%",bottom:"25%",margin:"auto",borderRadius:"20px",background:"white"},className:"popupInner"},s.a.createElement("h1",null,this.props.text),s.a.createElement("form",{onSubmit:this.handleSubmit},"username:",s.a.createElement("input",{type:"text",name:"username",onChange:this.handleChangeUsername}),s.a.createElement("br",null),"password:",s.a.createElement("input",{type:"text",name:"password",onChange:this.handleChangePassword}),s.a.createElement("br",null),s.a.createElement("input",{type:"submit",value:"Submit"}))))}}]),t}(s.a.Component);M.contextType=x;var T=M,U=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).sendMessage=function(e){console.log("sendMessage",e)},a.eventSource="",a.state={showPopup:!0,history:[],users:[]},a.sendMessage=a.sendMessage.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"handleSubmit",value:function(e,t){this.setState({showPopup:!this.state.showPopup})}},{key:"render",value:function(){return s.a.createElement(P,null,s.a.createElement("div",{className:"App"},this.state.showPopup?s.a.createElement(T,{text:"User Login",handleSubmit:this.handleSubmit.bind(this)}):null,s.a.createElement(N,null)))}}]),t}(n.Component);U.contextType=x;var J=U;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[51,1,2]]]);
//# sourceMappingURL=main.898c7f71.chunk.js.map